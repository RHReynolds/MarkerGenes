---
title: "Marker lists"
author: "Regina H. Reynolds"
output: 
  html_document:
    theme: paper
    highlight: kate
    df_print: paged
    toc: true
    toc_float: true
    number_sections: true
---

```{r setup, include=FALSE}

library(DT)
library(readxl)
library(EWCE)
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(stringr)

```


# Descriptions for metadata columns
```{r metadata columns, echo=FALSE, out.width='100%', fig.pos='H'}

readxl::read_excel(path = "/home/rreynolds/projects/MarkerGenes/metadata/dataset_metadata.xlsx", sheet = "ColumnDescriptions") %>% 
  DT::datatable(rownames = FALSE,
                options = list(scrollX = TRUE),
                class = 'white-space: nowrap')

```

# Dataset metadata
```{r metadata, echo=FALSE, out.width='100%', fig.pos='H'}

readxl::read_excel(path = "/home/rreynolds/projects/MarkerGenes/metadata/dataset_metadata.xlsx", sheet = "Data") %>% 
  arrange(desc(data_type), resource_name) %>% 
  DT::datatable(rownames = FALSE,
                options = list(scrollX = TRUE),
                class = 'white-space: nowrap')

```

- The majority of specificity matrices were downloaded from Skene 2018, but a few were also generated matrices from:
    - Zeisel et al. 2018 (see: `r  xfun::embed_file(path = "/home/rreynolds/projects/LDSC_Regression/R/EWCE/Zeisel2018_CNSClusters_FormattingDataForEWCE.R", name = "Zeisel2018_CNSClusters_FormattingDataForEWCE.R", text = "Zeisel2018_CNSClusters_FormattingDataForEWCE.R")`)
    - Allen Brain Atlas 2018 **(only MTG)** (see: [20190501_AIBS2018_GeneratingSImatrix.R](../misc_scripts/20190501_AIBS2018_GeneratingSImatrix.R)). 
        - Release is dated June 2018 (although only available on their website from around Spring 2019). At the time, only middle temporal gyrus (MTG) was available. As of Oct/November 2019, AIBS released all their single-nucleus RNA-seq expression, which also includes anterior cingulate cortex and primary visual cortex.
        - Used gene-level (exonic) read count values. While intronic values were available, reckoned that these would tag pre-mRNA.
    - [Agarwal 2020](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE140231) - currently unpublished. See: [20200331_SNIG_GeneratingSImatrix.R](../misc_scripts/20200331_SNIG_GeneratingSImatrix.R)
- Finally, specificity dataframe available for GTEx v8. Generated by modifying code from: https://github.com/jbryois/scRNA_disease/blob/master/Code_Paper/Code_GTEx/get_GTEx_input.md. For modified version, please refer to: [GTEx_v8_specificity.html](GTEx_v8_specificity.html)
 
